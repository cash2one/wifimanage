<!DOCTYPE html>
<html>
<head>
	<title><#:C('sitename')#>-管理后台</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /></head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0" , user-scalable=no />
<style type="text/css">
    #allmap{width: 85%;height: 300px; margin:0;font-family:"微软雅黑";}
</style>
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=nGa1MmrYfdZGeaQ5MTQtVkyu"></script>
	<include file="Pub:style"/>
	<!-- libraries -->
    <link href="<#$Theme['P']['root']#>/bootadmin/css/lib/uniform.default.css" type="text/css" rel="stylesheet" />
    <link href="<#$Theme['P']['root']#>/bootadmin/css/lib/select2.css" type="text/css" rel="stylesheet" />
    <link rel="stylesheet" href="<#$Theme['P']['root']#>/bootadmin/css/compiled/form-showcase.css" type="text/css" media="screen" />

<body>


<include file="Pub:Nav"/>
   <include file="Pub:Sidebar"/>

	<!-- main container -->
    <div class="content">
    	 <div class="container-fluid">
            <div id="pad-wrapper" class="form-page">

                <div class="row-fluid form-wrapper">
                 		<div class="span12">
                            <h4>编辑路由信息</h4>
                        </div>
                    <!-- left column -->
                    <div class="span8 column">
                        <form name="do" method="post" action="<#:U('addroute');#>">
                        <div class="alert span9" style="display: none;">
						  <span id="alertmsg"></span>
						</div>
						 <div class="field-box">
                                <label>所属商户:</label>
                                <input type="text"  class="span8"  readonly="true" value="<#$shop.shopname#>">
                                 <input type="hidden"  name="shopid"  value="<#$shop.id#>">
                         </div>

                            <div class="field-box">
                                <label>路由器名称:</label>
                                <input class="span8" type="text"  data-toggle="tooltip" data-trigger="focus" title="路由器名称不能超过20个字" data-placement="right" name="routename" id="routename" value="<#$info.routename#>"/>

                            </div>
                             <div class="field-box">
                                <label>MAC地址:</label>
                                <input class="span8" type="text" name="gw_id" id="gw_id" value="<#$info.gw_id#>"/>
                            </div>

                             <div class="field-box">
                                <label>路由排序:</label>
                                <input class="span8" type="text" name="sortid" id="sortid" value="<#$info.sortid#>" />
                            </div>
                            <div class="field-box">
                                <label>所属商圈:</label>
                                <div class="ui-select">
                                    <select name="province" id="province"><option value="北京市">北京市</option><option value="天津市">天津市</option><option value="河北省">河北省</option><option value="山西省">山西省</option><option value="内蒙古自治区">内蒙古自治区</option><option value="辽宁省">辽宁省</option><option value="吉林省">吉林省</option><option value="黑龙江省">黑龙江省</option><option value="上海市">上海市</option><option value="江苏省">江苏省</option><option value="浙江省">浙江省</option><option value="安徽省">安徽省</option><option value="福建省">福建省</option><option value="江西省">江西省</option><option value="山东省">山东省</option><option value="河南省">河南省</option><option value="湖北省">湖北省</option><option value="湖南省">湖南省</option><option value="广东省">广东省</option><option value="广西壮族自治区">广西壮族自治区</option><option value="海南省">海南省</option><option value="重庆市">重庆市</option><option value="四川省">四川省</option><option value="贵州省">贵州省</option><option value="云南省">云南省</option><option value="西藏自治区">西藏自治区</option><option value="陕西省">陕西省</option><option value="甘肃省">甘肃省</option><option value="青海省">青海省</option><option value="宁夏回族自治区">宁夏回族自治区</option><option value="新疆维吾尔自治区">新疆维吾尔自治区</option><option value="香港特别行政区">香港特别行政区</option><option value="澳门特别行政区">澳门特别行政区</option><option value="台湾省">台湾省</option><option value="其它">其它</option></select>
                                </div>
                                <div class="ui-select">
                                    <select name="city" id="city" ><option value="市辖区">市辖区</option><option value="市辖县">市辖县</option></select>
                                </div>
                                <div class="ui-select">
                                    <select name="area" id="area" ><option value="东城区">东城区</option><option value="西城区">西城区</option><option value="崇文区">崇文区</option><option value="宣武区">宣武区</option><option value="朝阳区">朝阳区</option><option value="丰台区">丰台区</option><option value="石景山区">石景山区</option><option value="海淀区">海淀区</option><option value="门头沟区">门头沟区</option><option value="房山区">房山区</option><option value="通州区">通州区</option><option value="顺义区">顺义区</option><option value="昌平区">昌平区</option><option value="大兴区">大兴区</option><option value="怀柔区">怀柔区</option><option value="平谷区">平谷区</option></select>
                                </div>
                            </div>
                            <div class="field-box">
                                <label>地址:</label>
                                <input class="span8" type="text"  data-toggle="tooltip" data-trigger="focus" title="输入商铺所在地址" data-placement="right" name="address" id="address" value="<#$shop.address#>"/>
                            </div>
                            <div class="field-box">
                                <div  id="allmap"></div>
                            </div>

                            <input type = "hidden" name = "lng" id = "lng" value = "" />
                            <input type = "hidden" name = "lat" id = "lat" value = "" />
                              <div class="field-box ">

                              <input type="hidden" name="id" id="id" value="<#$info.id#>">

                                <input type="submit"   class="btn-glow primary "  id="btn_save" value="确认编辑">
                               &nbsp;&nbsp;
                               <input type="button"   class="btn-glow  " id="btn_back" value="返回列表">


                            </div>
                        </form>
                    </div>

                    <!-- right column -->
                    <div class="span4 column pull-right">

                    </div>
                </div>
            </div>
        </div>
    </div>



	<!-- scripts -->
    <script src="<#$Theme['P']['js']#>/jquery.js"></script>
    <script src="<#$Theme['P']['root']#>/bootadmin/js/bootstrap.min.js"></script>
    <script src="<#$Theme['P']['root']#>/bootadmin/js/theme.js"></script>
     <script src="<#$Theme['P']['root']#>/bootadmin/js/jquery.uniform.min.js"></script>
  <script src="<#$Theme['P']['root']#>/bootadmin/js/common.js"></script>
<script src="<#$Theme['P']['js']#>/region_select.js"></script>
<script type="text/javascript">
    new PCAS('province', 'city', 'area', '<#$shop['province']#>', '<#$shop.city#>', '<#$shop.area#>');
</script>


<!-- call this page plugins -->
    <script type="text/javascript">


        $(function () {

            // add uniform plugin styles to html elements
            $("input:checkbox, input:radio").uniform();
            $('#btn_back').bind('click',function(){
				location.href="<#:U('index')#>";
			});
            $('#btn_save').bind('click',function(){
                var gw_id=$('#gw_id').val();
                if(gw_id == ""){
                    AlertTips("MAC不能为空",1500);
                    return false;
                }
            });

        });
        $('#address').blur(function () {
            var ad = $('#address').val();
            if (ad != "") {
                var pro = $('#province').val();
                var city = $('#city').val();
                var area = $('#area').val();
                var ad = $('#address').val();
                point = pro + city + area + ad;
            } else {
                point = "厦门";
            }

            var map = new BMap.Map("allmap",{});  // 创建Map实例
            map.centerAndZoom(point,16);      // 初始化地图,用城市名设置地图中心点

            map.enableScrollWheelZoom();    //启用滚轮放大缩小，默认禁用
            map.enableContinuousZoom();    //启用地图惯性拖拽，默认禁用

            //点击获取坐标
            map.addEventListener("click",function(e){

                //存储经纬度
                lng = e.point.lng;
                lat = e.point.lat;

                if (document.createElement('canvas').getContext) {  // 判断当前浏览器是否支持绘制海量点
                    var points = [];  // 添加海量点数据
                    points.push(new BMap.Point(lng,lat));
                    var options = {
                        size: BMAP_POINT_SIZE_SMALL,
                        shape: BMAP_POINT_SHAPE_STAR,
                        color: '#d340c3'
                    }
                    var pointCollection = new BMap.PointCollection(points, options);  // 初始化PointCollection
                    map.addOverlay(pointCollection);  // 添加Overlay
                } else {
                    alert('请在chrome、safari、IE8+以上浏览器查看本示例');
                }
                //坐标赋值给隐藏域
                $("#lng").attr("value",lng);
                $("#lat").attr("value",lat);
            });
        });
        var map = new BMap.Map("allmap");  // 创建Map实例
        map.centerAndZoom("厦门",12);      // 初始化地图,用城市名设置地图中心点
    </script>
</body>
</html>